# TASK模块测试配置文件
# 请根据实际情况修改以下配置

# ============================================
# 视频流配置
# ============================================
[video]
# RTSP输入流地址（必需）
# 您的摄像头: 192.168.1.64
# 使用子码流进行AI分析（推荐）⭐
# 子码流优势：延迟低、CPU占用少、推理快
# 分辨率：720p（足够AI检测使用）
# 如需高清录像/回放，可切换回主码流(101)
rtsp_url=rtsp://admin:sr336699@192.168.1.64:554/Streaming/Channels/102

# RTMP推流地址（可选）
rtmp_url=rtmp://localhost:1936/live/stream_test

# 视频分辨率配置（RTMP推流使用）
width=1280
height=720

# 推流帧率
fps=25


# ============================================
# AI推理配置
# ============================================
[ai]
# 是否启用AI推理
enable=true

# YOLOv11模型路径（ONNX格式）
# 如果您还没有模型，请先运行: .\scripts\download_yolo_model.ps1
model_path=F:/EASYLOT/easyaiot-main/TASK/models/yolov11n.onnx

# 类别文件路径（可选，如果模型是COCO训练的可以省略）
classes_path=F:/EASYLOT/easyaiot-main/TASK/models/coco.names

# 推理线程数量（1-4）
# CPU模式建议使用1个线程，GPU模式可以使用2-3个
threads=1


# ============================================
# 任务配置
# ============================================
[task]
# 任务ID（用于标识TASK实例）
id=camera_test_001

# HTTP控制端口（用于TaskManager远程控制推流启停）
# 默认: 8000 + taskId编号
# 例如: task_1=8001, task_2=8002, task_50=8050
control_port=8001



# ============================================
# 报警配置（测试告警回调）
# ============================================
[alarm]
# ⭐ HTTP回调地址（告警时POST到此URL）
# 使用现有的AlarmController AI告警接口
# 本地测试: http://localhost:48080/admin-api/device/alarm/ai
# 生产环境: http://{gateway_host}:48080/admin-api/device/alarm/ai
# 测试报警回调地址（边缘TASK模块 -> iot-device-biz -> iot-tdengine-biz -> TDengine）
 # 直接访问服务（无网关）：/alarm/ai
# 通过网关访问（生产环境）：/admin-api/device/alarm/ai
hook_url=http://localhost:48080/alarm/ai

# 报警置信度阈值（0.0-1.0）
confidence_threshold=0.5

# 报警冷却时间（秒）- 降低以便快速测试
cooldown_time=5


# ============================================
# 功能开关
# ============================================
[features]
# 启用RTMP推流
# - true: 将带AI检测框的视频推流到ZLMediaKit（需要先启动ZLM）
#         内存占用: ~175 MB/路，适用于需要实时观看的重点摄像头
# - false: 禁用推流，只做AI检测和告警
#         内存占用: ~64 MB/路，节省64%内存，适用于只需检测的普通摄像头
# 
# 💡 企业级部署建议：
#    - 重点区域（大门、停车场）: enable_rtmp=true（可实时观看）
#    - 普通区域（走廊、楼梯）: enable_rtmp=false（只做AI检测）
#    - 50路混合部署示例: 10路推流(1.8GB) + 40路纯检测(2.6GB) = 4.4GB总内存
# 
# ⚠️ 如果ZLMediaKit未启动，程序仍会继续运行，只是没有推流功能
enable_rtmp=true

# 启用检测框绘制
enable_draw=true

# 启用报警检测（开启告警回调）
enable_alarm=true


# ============================================
# 报警区域配置（ROI - Region of Interest）
# ============================================
[regions]
# 📍 报警区域定义（多边形坐标数组）
# 格式：area_name=[[x1,y1],[x2,y2],[x3,y3],...]
# 坐标系统：左上角为(0,0)，当前分辨率1280x720

# ⚠️ 当前ROI配置已禁用，等待前端页面绘制后通过API传入
# 如果没有配置ROI，则全画面都会触发检测（所有目标显示红色框）

# 🎯 测试区域示例（已禁用）
# area_center=[[340,160],[940,160],[940,560],[340,560]]
# area_left=[[50,50],[600,50],[600,670],[50,670]]
# area_bottom=[[100,400],[1180,400],[1180,670],[100,670]]


# ============================================
# 使用说明
# ============================================
# 
# 第一次测试建议：
# 1. 先修改 rtsp_url 为您的摄像头地址
# 2. 如果没有YOLO模型，设置 ai.enable=false
# 3. 设置 alarm.enable=false（暂时禁用报警）
# 4. 设置 features.enable_rtmp=false（暂时禁用推流）
# 
# 这样可以先测试RTSP拉流是否正常工作
# 
# 运行命令：
#   cd F:\EASYLOT\easyaiot-main\TASK\build\Release
#   .\TASK.exe ..\..\config\test.ini
# 

# 这样可以先测试RTSP拉流是否正常工作
# 
# 运行命令：
#   cd F:\EASYLOT\easyaiot-main\TASK\build\Release
#   .\TASK.exe ..\..\config\test.ini
# 
